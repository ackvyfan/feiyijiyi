<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>éé—ä¸­è‹±è¯­æ–™æŸ¥è¯¢å¹³å°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans CJK SC",sans-serif;
      margin: 0;
      background: #f5f5f7;
      color: #222;
    }

    /* æ•´ä½“å¸ƒå±€ï¼šå·¦ä¾§çª„æ  + å³ä¾§ä¸»å†…å®¹ */
    .app {
      display: flex;
      min-height: 100vh;
    }

    /* å·¦ä¾§å…³é”®è¯ä¸“æ ï¼šæ”¹æˆç±»ä¼¼ GPT çš„ç°è‰²ä¾§æ  */
    .sidebar {
      width: 240px;
      background: #202123;        /* æ·±ç°è‰²ï¼Œè€Œä¸æ˜¯è“é»‘è‰² */
      color: #e4e4e7;
      display: flex;
      flex-direction: column;
      padding: 12px 10px;

      height: 100vh;          /* ğŸ‘ˆ å…³é”®1ï¼šå·¦æ å›ºå®šå±å¹•é«˜åº¦ */
      overflow: hidden;       /* ğŸ‘ˆ å…³é”®2ï¼šå†…å®¹ä¸æŠŠé¡µé¢æ’‘å¼€ */
    }
    .sidebar-header {
      padding: 8px 6px 10px;
      border-bottom: 1px solid #3f3f46;
      margin-bottom: 6px;
    }
    .sidebar-title {
      font-size: 14px;
      font-weight: 600;
    }
    .sidebar-subtitle {
      font-size: 11px;
      color: #a1a1aa;
      margin-top: 2px;
    }
    .sidebar-count {
      font-size: 11px;
      color: #a1a1aa;
      margin-top: 4px;
    }
    .sidebar-keywords {
      flex: 1;
      margin-top: 6px;
      overflow-y: auto;
      padding-right: 4px;
    }
    .keyword-chip {
      display: block;
      padding: 4px 8px;
      margin: 2px 0;
      border-radius: 6px;
      font-size: 12px;
      color: #e5e7eb;
      text-overflow: ellipsis;
      white-space: nowrap;
      overflow: hidden;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s;
    }
    .keyword-chip:hover {
      background: #2f3133;
      transform: translateY(-1px);
    }
    .sidebar-footer {
      font-size: 10px;
      color: #9ca3af;
      padding: 6px 4px 2px;
      border-top: 1px solid #3f3f46;
      margin-top: 4px;
    }

    /* å³ä¾§ä¸»å†…å®¹åŒº */
    .main {
      flex: 1;
      padding: 24px;
      max-width: calc(100vw - 240px);
    }
    .container {
      max-width: 960px;
      margin: 0 auto;
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.06);
      padding: 20px 20px 18px;
    }
    h1 {
      margin: 0 0 6px;
      font-size: 22px;
      text-align: left;
    }
    .subtitle {
      font-size: 13px;
      color: #666;
      margin-bottom: 10px;
    }

    .top-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      gap: 8px;
      flex-wrap: wrap;
    }

    .search-area {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      flex: 1;
    }
    input[type="text"] {
      flex: 1;
      min-width: 180px;
      padding: 9px 12px;
      font-size: 15px;
      border-radius: 999px;
      border: 1px solid #ddd;
      outline: none;
    }
    input[type="text"]:focus {
      border-color: #007aff;
      box-shadow: 0 0 0 2px rgba(0,122,255,0.15);
    }
    button {
      padding: 9px 18px;
      border-radius: 999px;
      border: none;
      background: #007aff;
      color: #fff;
      font-size: 15px;
      cursor: pointer;
      font-weight: 600;
      white-space: nowrap;
    }
    button:hover { background: #0062cc; }

    /* â€œè¿”å›ä¸»é¡µé¢â€æŒ‰é’®ï¼šåšæˆæ¬¡æŒ‰é’®æ ·å¼ */
    .secondary-btn {
      padding: 7px 14px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: #f4f4f5;
      color: #374151;
      font-size: 13px;
      cursor: pointer;
      font-weight: 500;
    }
    .secondary-btn:hover {
      background: #e4e4e7;
    }

    .status {
      font-size: 12px;
      color: #888;
      min-height: 18px;
      margin-bottom: 4px;
    }
    .current-keyword {
      font-size: 13px;
      color: #374151;
      margin-bottom: 4px;
    }
    .results-info {
      font-size: 12px;
      color: #6b7280;
      margin-bottom: 6px;
    }
    .result-list {
      max-height: 520px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .card {
      border-radius: 12px;
      border: 1px solid #eee;
      padding: 10px 12px;
      margin-bottom: 8px;
      background: #fafafa;
    }
    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 4px;
    }
    .zh-text {
      font-weight: 600;
      font-size: 14px;
    }
    .en-text {
      font-size: 13px;
      color: #333;
      margin-top: 2px;
    }
    .tag-row {
      margin-top: 4px;
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      font-size: 11px;
      color: #666;
    }
    .tag {
      padding: 2px 6px;
      border-radius: 999px;
      background: #eef2ff;
    }
    .type-tag.word { background: #e0f7fa; }
    .type-tag.sentence { background: #e8f5e9; }
    .type-tag.paragraph { background: #fff3e0; }
    .small-label {
      font-size: 11px;
      color: #999;
      margin-top: 3px;
    }

    @media (max-width: 768px) {
      .app {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        flex-direction: row;
        flex-wrap: nowrap;
        overflow-x: auto;
        overflow-y: hidden;
        align-items: center;
      }
      .sidebar-header {
        border-bottom: none;
        border-right: 1px solid #3f3f46;
        margin-bottom: 0;
        padding-right: 8px;
        min-width: 140px;
      }
      .sidebar-keywords {
        flex: 1;
        white-space: nowrap;
        margin-top: 0;
      }
      .keyword-chip {
        display: inline-block;
        margin: 2px 4px;
      }
      .sidebar-footer {
        display: none;
      }
      .main {
        max-width: 100%;
        padding: 12px;
      }
      .container {
        padding: 14px;
        border-radius: 12px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <!-- å·¦ä¾§å…³é”®è¯ä¸“æ  -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="sidebar-title">æ‰€æœ‰å…³é”®è¯ï¼ˆè¯è¯­ï¼‰</div>
        <div class="sidebar-subtitle">ç‚¹å‡»ä»»æ„è¯è¯­æŸ¥çœ‹ç›¸å…³è¯­æ–™</div>
        <div class="sidebar-count" id="keywordsCount">æ­£åœ¨ç»Ÿè®¡å…³é”®è¯â€¦</div>
      </div>
      <div class="sidebar-keywords" id="keywordList">
        <!-- å…³é”®è¯ chip åŠ¨æ€ç”Ÿæˆ -->
      </div>
      <div class="sidebar-footer">
        æç¤ºï¼šæ­¤å¤„ä»…å±•ç¤ºâ€œè¯è¯­â€çº§å…³é”®è¯ä»¥ä¾¿æœç´¢
      </div>
    </aside>

    <!-- å³ä¾§ä¸»å†…å®¹ -->
    <main class="main">
      <div class="container">
        <h1>æ½®å·éé—æ–‡åŒ–ä¸­è‹±è¯­æ–™æŸ¥è¯¢å¹³å°</h1>
        <div class="subtitle">
          æ”¯æŒä¸­æ–‡ä¸è‹±æ–‡å…³é”®è¯æ£€ç´¢ï¼Œæ¶µç›–è¯è¯­ã€å¥å­ä¸æ®µè½ç­‰å¤šç§è¯­æ–™å½¢å¼ã€‚
        </div>

        <div class="top-actions">
          <div class="search-area">
            <input id="searchInput" type="text" placeholder="ä¾‹å¦‚ï¼šåµŒç“· / inlaid porcelain / æ½®å·å·¥å¤«èŒ¶è‰ºâ€¦" />
            <button id="searchBtn">æœç´¢</button>
          </div>
          <!-- è¿”å›ä¸»é¡µé¢æŒ‰é’® -->
          <button id="resetBtn" class="secondary-btn">è¿”å›ä¸»é¡µé¢</button>
        </div>

        <div id="status" class="status">æ­£åœ¨åŠ è½½è¯­æ–™æ•°æ® corpus.jsonâ€¦</div>
        <div id="currentKeywordTitle" class="current-keyword" style="display:none;"></div>
        <div id="resultsInfo" class="results-info" style="display:none;"></div>
        <div id="resultList" class="result-list"></div>
      </div>
    </main>
  </div>

  <script>
    const inputEl   = document.getElementById('searchInput');
    const btnEl     = document.getElementById('searchBtn');
    const resetBtn  = document.getElementById('resetBtn');
    const statusEl  = document.getElementById('status');
    const infoEl    = document.getElementById('resultsInfo');
    const listEl    = document.getElementById('resultList');
    const currentKeywordTitleEl = document.getElementById('currentKeywordTitle');

    const keywordListEl   = document.getElementById('keywordList');
    const keywordsCountEl = document.getElementById('keywordsCount');

    let corpus = [];
    let allKeywords = []; // ä»…ä»â€œè¯è¯­â€ï¼ˆtype=wordï¼‰ä¸­æå–çš„å…³é”®è¯

    // è¯» corpus.json å¹¶ç”Ÿæˆå…³é”®è¯ï¼ˆåªç”¨ type === 'word' çš„é¡¹ï¼‰
    fetch('corpus.json')
      .then(res => {
        if (!res.ok) {
          throw new Error('HTTP çŠ¶æ€ç ï¼š' + res.status);
        }
        return res.json();
      })
      .then(json => {
        corpus = json;
        statusEl.textContent = `è¯­æ–™åŠ è½½å®Œæˆï¼Œå…± ${corpus.length} æ¡è®°å½•ã€‚`;

        const set = new Set();
        const wordItems = corpus.filter(item => item.type === 'word'); // åªå–â€œè¯è¯­â€
        wordItems.forEach(item => {
          if (item.zh && item.zh.trim()) set.add(item.zh.trim());
          if (item.en && item.en.trim()) set.add(item.en.trim());
        });
        allKeywords = Array.from(set);
        allKeywords.sort((a, b) => a.localeCompare(b, 'zh-CN'));

        keywordsCountEl.textContent = `å…± ${allKeywords.length} ä¸ªè¯è¯­å…³é”®è¯`;
        renderKeywordList();
      })
      .catch(err => {
        console.error('åŠ è½½ corpus.json å‡ºé”™ï¼š', err);
        statusEl.textContent = 'è¯­æ–™åŠ è½½å¤±è´¥ï¼š' + err.message;
      });

    // æ¸²æŸ“å·¦ä¾§å…³é”®è¯ä¸“æ 
    function renderKeywordList() {
      if (!allKeywords.length) {
        keywordListEl.innerHTML = '<div style="font-size:11px;color:#9ca3af;">æš‚æ— å¯ç”¨è¯è¯­å…³é”®è¯ã€‚</div>';
        return;
      }

      keywordListEl.innerHTML = allKeywords.map(k => `
        <span class="keyword-chip" data-key="${k.replace(/"/g, '&quot;')}">${k}</span>
      `).join('');

      keywordListEl.onclick = function(e) {
        const target = e.target;
        if (target.classList.contains('keyword-chip')) {
          const key = target.getAttribute('data-key');
          openKeywordDetail(key);
        }
      };
    }

    // ä»å·¦ä¾§è¯è¯­æ‰“å¼€è¯¦æƒ…ï¼ˆå³ä¾§ä¸»åŒºåŸŸå±•ç¤ºå¯¹åº”è¯­æ–™ï¼‰
    function openKeywordDetail(keyword) {
      if (!corpus.length) return;

      inputEl.value = keyword;  // åŒæ­¥å¡«åˆ°æœç´¢æ¡†
      const keyLower = keyword.toLowerCase();
      const hasChinese = /[\u4e00-\u9fa5]/.test(keyword);

      const results = corpus.filter(item => {
        const zh = (item.zh || '');
        const en = (item.en || '');
        if (hasChinese) {
          return zh.includes(keyword);
        } else {
          return zh.toLowerCase().includes(keyLower) || en.toLowerCase().includes(keyLower);
        }
      });

      currentKeywordTitleEl.style.display = 'block';
      currentKeywordTitleEl.textContent = `å½“å‰å…³é”®è¯ï¼š${keyword}`;
      infoEl.style.display = 'block';
      infoEl.textContent = `å…± ${results.length} æ¡ç›¸å…³è¯­æ–™`;
      statusEl.textContent = '';

      renderResults(results, listEl);
    }

    // æœç´¢åŠŸèƒ½ï¼ˆå³ä¾§æœç´¢æ¡†ï¼‰
    function doSearch() {
      const q = inputEl.value.trim();
      if (!q) {
        statusEl.textContent = 'è¯·è¾“å…¥è¦æœç´¢çš„ä¸­æ–‡æˆ–è‹±æ–‡å…³é”®è¯ã€‚';
        infoEl.style.display = 'none';
        currentKeywordTitleEl.style.display = 'none';
        listEl.innerHTML = '';
        return;
      }
      if (!corpus.length) {
        statusEl.textContent = 'è¯­æ–™å°šæœªåŠ è½½å®Œæˆï¼Œè¯·ç¨åå†è¯•ã€‚';
        return;
      }

      statusEl.textContent = '';
      const qLower = q.toLowerCase();
      const hasChinese = /[\u4e00-\u9fa5]/.test(q);

      const results = corpus.filter(item => {
        const zh = (item.zh || '');
        const en = (item.en || '');
        if (hasChinese) {
          return zh.includes(q);
        } else {
          return zh.toLowerCase().includes(qLower) || en.toLowerCase().includes(qLower);
        }
      });

      currentKeywordTitleEl.style.display = 'block';
      currentKeywordTitleEl.textContent = `æœç´¢ï¼š${q}`;
      infoEl.style.display = 'block';
      infoEl.textContent = `æ‰¾åˆ° ${results.length} æ¡ç»“æœ`;

      renderResults(results, listEl);
    }

    // â€œè¿”å›ä¸»é¡µé¢â€æŒ‰é’®ï¼šæ¢å¤åˆå§‹çŠ¶æ€
    function resetHome() {
      inputEl.value = '';
      currentKeywordTitleEl.style.display = 'none';
      infoEl.style.display = 'none';
      listEl.innerHTML = '';
      if (corpus.length) {
        statusEl.textContent = `è¯­æ–™åŠ è½½å®Œæˆï¼Œå…± ${corpus.length} æ¡è®°å½•ã€‚`;
      } else {
        statusEl.textContent = '';
      }
    }

    // é€šç”¨ç»“æœæ¸²æŸ“
    function renderResults(list, mountEl) {
      if (!list.length) {
        mountEl.innerHTML = '<div class="small-label">æ²¡æœ‰åŒ¹é…ç»“æœï¼Œå¯ä»¥å°è¯•æ¢ä¸€ä¸ªå…³é”®è¯ã€‚</div>';
        return;
      }
      const html = list.map(item => {
        const typeMap = { word: 'è¯è¯­', sentence: 'å¥å­', paragraph: 'æ®µè½' };
        const typeLabel = typeMap[item.type] || item.type;
        const typeClass = item.type || '';

        return `
          <div class="card">
            <div class="card-header">
              <div class="zh-text">${item.zh || '<span style="color:#aaa;">ï¼ˆæ— ä¸­æ–‡ï¼‰</span>'}</div>
              <div class="tag type-tag ${typeClass}">${typeLabel}</div>
            </div>
            <div class="en-text">${item.en || '<span style="color:#aaa;">ï¼ˆæ— è‹±æ–‡ï¼‰</span>'}</div>
            <div class="tag-row">
              ${item.project ? `<span class="tag">éé—é¡¹ç›®ï¼š${item.project}</span>` : ''}
              ${item.category ? `<span class="tag">ç±»åˆ«ï¼š${item.category}</span>` : ''}
              ${item.strategy ? `<span class="tag">ç¿»è¯‘ç­–ç•¥ï¼š${item.strategy}</span>` : ''}
              ${item.source ? `<span class="tag">æ¥æºï¼š${item.source}</span>` : ''}
            </div>
          </div>
        `;
      }).join('');
      mountEl.innerHTML = html;
    }

    // äº‹ä»¶ç»‘å®š
    btnEl.addEventListener('click', doSearch);
    inputEl.addEventListener('keydown', e => {
      if (e.key === 'Enter') doSearch();
    });
    resetBtn.addEventListener('click', resetHome);
  </script>
</body>
</html>

